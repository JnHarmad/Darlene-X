<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ForensiPie - Analysis Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1, h2, h3 { color: #444; }
        ul { margin-top: 0; }
        .verdict { font-weight: bold; font-size: 1.2em; }
        .malicious { color: red; }
        .safe { color: green; }
    </style>
</head>
<body>
    <h1>ForensiPie - Static Analysis Report</h1>

    <h2>Maliciousness Verdict</h2>
    {% if maliciousness.status == "MALICIOUS" %}
        <p class="verdict malicious">⚠️ Device Classified as MALICIOUS</p>
        <ul>
            {% for reason in maliciousness.reasons %}
                <li>{{ reason }}</li>
            {% endfor %}
        </ul>
    {% elif maliciousness.status == "SAFE" %}
        <p class="verdict safe">✅ Device Classified as SAFE — No major issues detected.</p>
    {% else %}
        <p>Status: {{ maliciousness.status }}</p>
        <p>Error: {{ maliciousness.error }}</p>
    {% endif %}

    <h2>Module-wise Analysis</h2>
    {% for module, result in analysis.items() %}
        <h3>{{ module.replace("_", " ") | title }}</h3>
        {% if result is string %}
            <p>{{ result }}</p>
        {% elif result is mapping %}
            <ul>
                {% for key, val in result.items() %}
                    <li><strong>{{ key }}:</strong> {{ val }}</li>
                {% endfor %}
            </ul>
        {% elif result is iterable %}
            <ul>
                {% for item in result %}
                    <li>{{ item }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endfor %}
</body>
</html>
