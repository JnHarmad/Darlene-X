<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ForensiPie - Analysis Report</title>
</head>
<body>
    <h1>ForensiPie - Analysis Report</h1>
    <p><strong>Package Name:</strong> {{ package_name }}</p>
    <p><strong>Version:</strong> {{ version }}</p>
    <p><strong>Min SDK Version:</strong> {{ min_sdk_version }}</p>
    <p><strong>Target SDK Version:</strong> {{ target_sdk_version }}</p>
    <h2>Permissions</h2>
    <ul>
        {% for permission in permissions %}
        <li>{{ permission }}</li>
        {% endfor %}
    </ul>
    <h2>Activities</h2>
    <ul>
        {% for activity in activities %}
        <li>{{ activity }}</li>
        {% endfor %}
    </ul>
    <h2>Services</h2>
    <ul>
        {% for service in services %}
        <li>{{ service }}</li>
        {% endfor %}
    </ul>
    <h2>Receivers</h2>
    <ul>
        {% for receiver in receivers %}
        <li>{{ receiver }}</li>
        {% endfor %}
    </ul>
    <h2>Certificates</h2>
    <ul>
        {% for cert in certificates %}
        <li>
            <strong>Subject:</strong> {{ cert.subject }}<br>
            <strong>Issuer:</strong> {{ cert.issuer }}<br>
            <strong>Serial Number:</strong> {{ cert.serial_number }}<br>
            <strong>SHA256 Fingerprint:</strong> {{ cert.sha256_fingerprint }}
        </li>
        {% endfor %}
    </ul>
    <h2>Obfuscation</h2>
    <p><strong>Obfuscation Detected:</strong> {{ "Yes" if obfuscation_detected else "No" }}</p>
    {% if obfuscation_detected %}
    <h3>Obfuscated Classes</h3>
    <ul>
        {% for cls in obfuscated_classes %}
        <li>{{ cls }}</li>
        {% endfor %}
    </ul>
    <h3>Obfuscated Methods</h3>
    <ul>
        {% for method in obfuscated_methods %}
        <li>{{ method }}</li>
        {% endfor %}
    </ul>
    {% endif %}
</body>
</html>